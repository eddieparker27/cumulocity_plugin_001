/* core_tenantApplications 9.16.4 2018-11-07T09:49:03+00:00 f3088a38af4a (release/9.16.0) tip */
!function(){"use strict";function n(n,t){n.when("/tenants/:tenantId",{templateUrl:"core_tenantApplications/views/index.html",controller:"tenantAppAssignmentCtrl",icon:"c8y-modules",name:t("Applications"),priority:3e3,showIf:["$routeParams",function(n){return n&&"new"!==n.tenantId}]})}angular.module("c8y.tenantApplications",[]).config(["c8yViewsProvider","gettext",n])}(),function(){"use strict";function n(n,t,i,a,e,s,l,c){function r(){h&&"new"!==h&&e.detail(h).then(l.getResData).then(o).then(p).then(a.sortApps).then(function(t){n.associatedApplications=t})}function o(t){n.tenant=w=t}function p(){return n.tenant.applications.references.map(function(n){return n.application})}function u(){a.listByTenant().then(function(n){return _.uniqBy(n,"id")}).then(d)}function d(t){_.forEach(t,function(n){return y.push(n)}),b(y),n.applications=y}function b(t){n.owners=_(t).map("owner.tenant.id").uniq().map(function(n){return{value:n,label:n}}).concat({value:null,label:"- "+c.getString("Show all")}).value()}function m(t){return e.addApplication(w,t).then(function(){n.associatedApplications.push(t)})}function v(t){return e.removeApplication(w,t).then(function(){return l.removeFromList(n.associatedApplications,t)})}function f(n){A=A!==n?n:null}function g(n){return A===n}var h=t.tenantId,y=[],A=null,w={};n.filterOwner=function(t){return null===n.filter.owner||t.owner.tenant.id===n.filter.owner},n.applications=y,n.associate=m,n.dissociate=v,n.openItem=f,n.isOpen=g,n.filter={owner:null,text:{}},r(),u()}n.$inject=["$scope","$routeParams","$uibModal","c8yApplication","c8yTenant","c8yAlert","c8yBase","gettextCatalog"],angular.module("c8y.tenantApplications").controller("tenantAppAssignmentCtrl",n)}(),function(){"use strict";function n(n,t){function i(){a().then(e).then(t.getApplicationMOs).then(s)}function a(){var n={subscriber:v,pageSize:100,withTotalPages:!0};return t.listApplications(n)}function e(n){h=n}function s(n){_.forEach(n,function(n){_.find(h,{id:n.applicationId})&&(g[n.applicationId]=n)})}function l(n){y=y!==n?n:null,y&&c(n.id)}function c(n){var t=r(n);t?o(t):m.instances={}}function r(n){var i=_.get(g,n);return t.getApplicationStatusForTenant(i,v)}function o(n){m.instances=t.getInstanceCounts(_.get(n,"details"))}function p(n){return y===n}function u(n){var t=r(n.id);return!_.isEmpty(t)}function d(n){var i=_.find(t.status.values(),{value:_.get(r(n),"status")});return _.get(i,"icon")}function b(n){var i=_.find(t.status.values(),{value:_.get(r(n),"status")});return _.get(i,"label")}var m=this,v=n.tenantId,f={},g={},h=[],y=null;_.assign(m,{$onInit:i,openItem:l,isOpen:p,hasApplicationStatus:u,instances:f,getStatusIcon:d,getStringTooltip:b})}n.$inject=["$routeParams","c8yApplication"],angular.module("c8y.tenantApplications").component("c8ySubscribedApplications",{bindings:{associatedApplications:"<",dissociate:"<"},templateUrl:"core_tenantApplications/subscribed-applications/subscribed-applications.html",controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n){var t;t='<div class="col-md-6">\r\n  <div class="card">\r\n    <div class="card-header">\r\n      <h4 translate>Subscribed applications</h4>\r\n    </div>\r\n    <ul class="list-group card-inner-scroll" style="max-height:calc(100vh - 227px)">\r\n      <li class="list-group-item flex-row collapsible" ng-class="{\'expanded\': vm.isOpen(a)}" ng-repeat="a in vm.associatedApplications">\r\n        <div class="list-item-body flex-row">\r\n          <c8y-app-icon app="::a" style="font-size: 30px"></c8y-app-icon>\r\n          <p style="margin-left: 10px">{{a | humanizeAppName}}</p>\r\n          <div class="list-item-icon" ng-if="vm.getStatusIcon(a.id)">\r\n            <i c8y-icon="{{vm.getStatusIcon(a.id)}}" uib-tooltip="{{vm.getStringTooltip(a.id) | translate}}" tooltip-placement="right" style="margin-left: 5px">\r\n            </i>\r\n          </div>\r\n          <button ng-click="vm.dissociate(a)" style="margin-right: 30px" class="btn btn-primary btn-xs showOnHover flex-item-right" translate>unsubscribe</button>\r\n        </div>\r\n        <div class="list-item-actions" ng-if="vm.hasApplicationStatus(a)">\r\n          <button type="button" title="{{\'Expand\' | translate}}" class="collapse-btn" ng-click="vm.openItem(a)">\r\n            <i c8y-icon="chevron-down"></i>\r\n          </button>\r\n        </div>\r\n        <div uib-collapse="!vm.isOpen(a)">\r\n          <div>\r\n            <span ng-repeat="(instance, value) in vm.instances" style="margin-right: 10px">\r\n              <label class="small">{{instance | translate}}:</label>\r\n              {{value || \'0\'}}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n',n.put("tenantApplications/subscribed-applications/subscribed-applications.html",t),n.put("core_tenantApplications/subscribed-applications/subscribed-applications.html",t),n.put("/apps/core/tenantApplications/subscribed-applications/subscribed-applications.html",t),t='<c8y-breadcrumbs-set>\n  <c8y-breadcrumbs-item path="#tenants" label="{{\'Tenants\' | translate}}" icon="c8y-sub-tenants"></c8y-breadcrumbs-item>\n</c8y-breadcrumbs-set>\n\n<div class="row">\n  <c8y-subscribed-applications dissociate="dissociate" associated-applications="associatedApplications">\n  </c8y-subscribed-applications>\n\n  <div class="col-md-6">\n    <div class="card">\n      <div class="card-header">\n        <h4 class="card-title" translate>Available applications</h4>\n      </div>\n      <hr>\n      <div class="card-block">\n        <div class="form-inline">\n          <div class="input-group input-group-search" style="display: inline-table">\n            <input type="search" class="form-control" ng-model="filter.text.$" placeholder="{{\'Filterâ€¦\' | translate}}">\n            <span class="input-group-addon">\n              <i c8y-icon="search" ng-show="filter.text.$.length === 0 || !filter.text.$ "></i>\n              <i c8y-icon="times" class="text-muted" ng-show="filter.text.$.length > 0" ng-click="filter.text.$ = \'\'"></i>\n            </span>\n          </div>\n\n\n\n          <label class="control-label">{{\'Owner\' | translate}}:</label>\n          <div class="c8y-select-wrapper">\n            <select ng-options="owner.value as owner.label for owner in owners | orderBy:\'label\'" ng-model="filter.owner" class="form-control"></select>\n            <span></span>\n          </div>\n        </div>\n      </div>\n      <ul class="list-group card-inner-scroll" style="max-height:calc(100vh - 294px)">\n\n        <li class="list-group-item flex-row collapsible" ng-class="{\'expanded\': isOpen(a)}" ng-repeat="a in applications|filter:filterOwner|filter:filter.text">\n\n          <div class="list-item-body flex-row">\n            <c8y-app-icon app="::a" style="font-size: 30px"></c8y-app-icon>\n            <p style="margin-left: 10px">{{a | humanizeAppName}}</p>\n\n            <button ng-click="associate(a)" style="margin-right: 30px" class="btn btn-primary btn-xs showOnHover flex-item-right" translate>subscribe</button>\n          </div>\n          <div class="list-item-actions">\n            <button type="button" title="{{\'Expand\' | translate}}" class="collapse-btn" ng-click="openItem(a)">\n              <i c8y-icon="chevron-down"></i>\n            </button>\n          </div>\n          <div uib-collapse="!isOpen(a)">\n            <p><label class="small">{{\'Availability\' | translate}}:</label> {{a.availability}}</p>\n            <p><label class="small">{{\'Type\' | translate}}:</label> {{a.type}}</p>\n            <p><label class="small">{{\'Owner\' | translate}}:</label> {{a.owner.tenant.id}}</p>\n          </div>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>',n.put("tenantApplications/views/index.html",t),n.put("core_tenantApplications/views/index.html",t),n.put("/apps/core/tenantApplications/views/index.html",t)}angular.module("c8y.tenantApplications").run(["$templateCache",n])}();