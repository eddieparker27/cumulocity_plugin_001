/* core_deviceControlRelayArray 9.16.4 2018-11-07T09:48:09+00:00 f3088a38af4a (release/9.16.0) tip */
!function(){"use strict";function e(e,r){e.add({name:"deviceControlRelayArrayWidget",nameDisplay:r("Relay array control"),description:r("Remote control a device's relay array."),templateUrl:"core_deviceControlRelayArray/widget.html",options:{groupsSelectable:!1}})}angular.module("c8y.deviceControl.relayArray",[]).config(["c8yComponentsProvider","gettext",e])}(),function(){"use strict";function e(e,r){function t(){var t=r.deviceId;return e.child.config&&e.child.config.device&&e.child.config.device.id&&(t=e.child.config.device.id),t}this.getDeviceId=t}angular.module("c8y.deviceControl.relayArray").controller("deviceControlRelayArrayWidgetCtrl",["$scope","$routeParams",e])}(),function(){"use strict";function e(){return{restrict:"E",scope:{device:"&",suppressAlerts:"&",onSuccess:"&",onError:"&"},controller:"c8yRelayArrayControlCtrl",controllerAs:"vm",templateUrl:"core_deviceControlRelayArray/relayArrayControl/relayArrayControl.html"}}angular.module("c8y.deviceControl.relayArray").directive("c8yRelayArrayControl",e)}(),function(){"use strict";function e(e,r,t,n,o,a,i){function l(e){var r=_.cloneDeep(D.c8y_RelayArray),t=c(r[e])?"OPEN":"CLOSED";s(e,t);var n=y(r,t,e);u(e)&&d(n)}function c(e){return"CLOSED"===e}function s(e,r){$=_($).push({relayIndex:e,targetRelayState:r}).uniqBy("relayIndex").value()}function y(e,r,t){var n={deviceId:D.id,c8y_RelayArray:e};n.c8y_RelayArray[t]=r;var o=a(c(r)?"Close relay {{relayNo}}":"Open relay {{relayNo}}");return n.description=i.getString(o,{relayNo:t+1}),n}function u(e){return _.isEqual(_.head($).relayIndex,e)}function d(e){n.createWithNotifications(e).then(function(r){r.created.then(function(){v(e)}),r.completed.then(function(e){p(e)})})}function v(e){C(i.getString('Sent operation: "{{description | translate}}"!',{description:i.getString(e.description)}))}function p(e){if($=_.drop($),e.status===n.status.SUCCESSFUL?g(e):e.status===n.status.FAILED&&f(e),$.length){var r=_.head($).relayIndex;l(r)}}function g(r){C(i.getString('Successfully executed operation: "{{description | translate}}"!',{description:i.getString(r.description)})),e.onSuccess&&e.onSuccess({operationResult:r})}function f(r){A(r.failureReason?i.getString('Failed to execute operation beacuse of reason: "{{failureReason}}"!',{failureReason:i.getString(r.failureReason)}):a("Failed to execute operation!")),e.onFailure&&e.onFailure({operationResult:r})}function C(e){m(o.success,e)}function A(e){m(o.danger,e)}function m(e,r){h()||e(r)}function h(){return e.suppressAlerts&&e.suppressAlerts()}function R(){return t.supportsOperation(D,"c8y_RelayArray")}function S(e,r){var t=void 0;return t=x(e)?"fa-circle-o-notch fa-spin":c(r)?"fa-check text-success":"fa-ban text-danger"}function x(e){return _.find($,{relayIndex:e})}function I(t){var n=t&&(t.id||t);n&&r.detailRealtime(n,e).then(function(e){D=e,b.deviceRealtime=e})}var b=this,$=[],D=void 0;_.assign(b,{toggle:l,isSupported:R,isClosed:c,iconClass:S,isOperationInQueue:x}),e.$watch("device()",I)}e.$inject=["$scope","c8yInventory","c8yDevices","c8yDeviceControl","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.deviceControl.relayArray").controller("c8yRelayArrayControlCtrl",e)}(),function(){"use strict";function e(e){var r;r='<div>\n  <div ng-hide="vm.isSupported()" class="alert alert-warning" translate>\n    Operation not supported by this device\n  </div>\n  <div ng-show="vm.isSupported()">\n    <button type="button" ng-click="vm.toggle($index)" ng-repeat="rl in vm.deviceRealtime.c8y_RelayArray track by $index" ng-disabled="vm.isOperationInQueue($index)" class="btn c8y-btn-checkbox" ng-class="{\'active\': vm.isClosed(rl)}">\n      <i class="fa" ng-class="vm.iconClass($index, rl)"></i>\n      {{$index + 1}}\n    </button>\n  </div>\n</div>',e.put("deviceControlRelayArray/relayArrayControl/relayArrayControl.html",r),e.put("core_deviceControlRelayArray/relayArrayControl/relayArrayControl.html",r),e.put("/apps/core/deviceControlRelayArray/relayArrayControl/relayArrayControl.html",r),r='<div ng-controller="deviceControlRelayArrayWidgetCtrl as ctrl" style="padding: 10px">\n  <c8y-relay-array-control device="ctrl.getDeviceId()"></c8y-relay-array-control>\n</div>\n',e.put("deviceControlRelayArray/widget.html",r),e.put("core_deviceControlRelayArray/widget.html",r),e.put("/apps/core/deviceControlRelayArray/widget.html",r)}angular.module("c8y.deviceControl.relayArray").run(["$templateCache",e])}();